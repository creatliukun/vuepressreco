---
title: HTTP协议
date: 2025-03-29
tags:
 - ajax
categories:
#  - 服务端
 - Server
---


# 协议
## HTTP协议
### get和post的区别
+ get请求：
+ get请求是向服务器发送请求，请求参数是拼接在url后面，所以get请求的参数长度是有限制的，而且参数是明文可见的，不安全。
+ post请求：
+ post请求是向服务器发送请求，请求参数是放在请求体中，所以post请求的参数长度是无限制的，而且参数是隐藏的，安全。
### post和put的区别
+ put请求：
+ 不会增加数据种类，而是更新数据
+ post请求：
+ 增加数据种类，创建新内容
### 常见的http请求头
### 常见的http响应头
+ Content-Type：响应体的类型
### Content-Type的四种类型
+ text/html：html格式的文本
+ application/json：json格式的文本
+ application/x-www-form-urlencoded：form格式的文本，浏览器的原生form表单
+ multipart/form-data：form格式的文本，post请求的form表单
### http状态码304多好还是少一点好
+ 304：缓存有效，直接返回缓存内容，不需要重新请求服务器
+ 304过多，会造成以下问题
  - 网站收录减少
  - 权重下降
  - 网站快照停止
### 常见的http的请求方法
+ GET：获取资源
+ POST：创建资源,将实体提交到指定的资源，通常会造成服务器资源的更改
+ PUT：更新资源
+ DELETE：删除资源
+ HEAD：获取报文首部，与get相比，不反回主体报文
+ OPTIONS：获取资源支持的请求方法，可以用来跨域请求
+ CONNECT：用于建立到代理服务器的隧道，进行代理服务器到服务器的连接
+ TRACE：用于回环测试，回环测试是服务器端对客户端的请求进行跟踪，通常用于测试服务器是否能正常响应请求

### OPTIONS请求方法与使用场景
+ OPTIONS方法适用于请求获得由REQUESt-URL标识的资源在请求/响应的通信过程中可以使用的功能选项，通过这个方法，客户端可以在采取具体资源请求之前，决定对资源采取哪一种必要措施，或者了解服务器的性能。该请求方法的响应不能缓存。
+ 适用场景：主要有两个
  - 获取服务器支持的所有HTTP请求方法
  - 用来检查访问权限，例如，在CORS跨域资源共享时，对于复杂请求，就是使用OPTIONAS发送嗅申请，以判断是否有对指定资源的访问权限

### http和https的区别
+ HTTPS协议需要CA证书，费用较高；而HTTP协议不需要CA证书，免费。
+ HTTP协议时超文本传输协议，信息时明文传输的。HPPTS则是超文本传输安全协议，信息是加密传输的。
+ 使用不同的连接方式，端口不同，80端口是http协议，443端口是https协议。
+ HTTP协议连接很简单，是无状态的，而HTTPS协议是有SSL和HTTP协议构建的可进行加密传输、身份认证的网络协议，比HTTP协议安全。

### get请求方法URL长度限制的原因

GET 请求的 URL 长度限制主要由以下几个因素决定：

---

#### 1. **浏览器的限制**
- **不同浏览器对 URL 长度有不同的限制**：
  - **Internet Explorer (IE)**：最大 URL 长度为 2,083 个字符。
  - **Google Chrome**：理论上支持非常长的 URL（约 2,000,000 个字符），但实际使用中受服务器或其他网络组件的限制。
  - **Firefox**：支持的 URL 长度约为 65,536 个字符。
  - **Safari**：支持的 URL 长度与 Chrome 类似，但同样受限于其他因素。

---

#### 2. **服务器的限制**
- **Web 服务器对 URL 的解析能力有限**：
  - **Apache**：默认支持的 URL 长度为 8,192 个字符，可以通过配置调整。
  - **Nginx**：默认支持的 URL 长度为 4,000 个字符，也可以通过 `large_client_header_buffers` 参数调整。
  - **IIS（Internet Information Services）**：默认支持的 URL 长度为 16,384 个字符，可以通过 `maxUrlLength` 和 `maxQueryString` 配置项调整。

---

#### 3. **协议的限制**
- **HTTP 协议本身没有明确限制 URL 的长度**，但实际实现中会受到以下约束：
  - **TCP/IP 数据包大小**：HTTP 请求最终通过 TCP/IP 协议传输，单个数据包的最大大小通常为 65,535 字节（IPv4）。如果 URL 过长，可能需要分片传输，增加复杂性和潜在错误。
  - **代理服务器和负载均衡器**：这些中间件可能会对 URL 长度施加额外限制。

---

#### 4. **安全性考虑**
- **过长的 URL 可能引发安全问题**：
  - 恶意用户可能利用超长 URL 导致服务器资源耗尽（如 DOS 攻击）。
  - URL 中包含敏感信息（如密码或令牌）时，过长的 URL 增加了泄露风险。

---

#### 5. **缓存和书签的限制**
- **浏览器缓存和书签功能**：
  - 如果 URL 过长，可能导致缓存或书签存储失败。
  - 某些浏览器或设备对书签的长度有硬性限制。

---

#### 6. **推荐的最佳实践**
- **RFC 3986**（URI 标准）虽然没有明确规定 URL 的最大长度，但建议开发者将 GET 请求的 URL 长度控制在 **2,000 个字符以内**，以兼容大多数浏览器和服务器。

---

#### 总结

GET 请求的 URL 长度限制是由 **浏览器、服务器、协议、安全性** 等多方面因素共同决定的。为了避免兼容性问题，建议在设计 API 或 Web 应用时，尽量避免传递过长的参数。如果需要传递大量数据，可以考虑使用 POST 请求，将数据放在请求体中而非 URL 中。

### 当在浏览器中输入 Google.com 并且按下回车键之后发生了什么？

当用户在浏览器地址栏中输入 `Google.com` 并按下回车键后，会触发一系列复杂的操作。以下是详细的过程分解：

---

#### 1. **DNS 解析**
- 浏览器首先检查是否缓存了 `Google.com` 的 IP 地址。
- 如果没有缓存，浏览器会向本地 DNS 服务器发起请求，将域名 `Google.com` 转换为对应的 IP 地址。
- DNS 查询可能涉及多个层级的 DNS 服务器（如根服务器、顶级域名服务器和权威域名服务器）。

---

#### 2. **建立 TCP 连接**
- 浏览器通过解析得到的 IP 地址与目标服务器建立 TCP 连接。
- 如果使用 HTTPS 协议，还会进行以下步骤：
  - **TLS 握手**：浏览器与服务器协商加密算法，并验证服务器证书的有效性。
  - **密钥交换**：双方生成共享密钥，用于后续通信的加密和解密。

---

#### 3. **发送 HTTP 请求**
- 浏览器向服务器发送一个 HTTP 或 HTTPS 请求，通常是一个 GET 请求，例如：
  ```http
  GET / HTTP/1.1
  Host: google.com
  Connection: keep-alive
  User-Agent: Mozilla/5.0 ...
  Accept: text/html,application/xhtml+xml,...
  ```
- 请求头中包含浏览器信息、支持的 MIME 类型、语言偏好等。

---

#### 4. **服务器处理请求**
- 目标服务器接收请求并解析 URL 和请求头。
- 根据请求的内容，服务器执行相应的逻辑（如查询数据库、渲染页面等）。
- 服务器生成响应内容，通常是 HTML 页面，也可能包括 CSS、JavaScript 和图片等资源。

---

#### 5. **返回 HTTP 响应**
- 服务器将响应内容发送回浏览器，响应格式如下：
  ```http
  HTTP/1.1 200 OK
  Content-Type: text/html; charset=UTF-8
  Content-Length: 12345
  ...
  
  <!DOCTYPE html>
  <html>...</html>
  ```

---

#### 6. **浏览器解析和渲染**
- 浏览器接收到响应后，开始解析 HTML 内容。
- **构建 DOM 树**：根据 HTML 结构生成 DOM 树。
- **解析 CSS**：下载并解析外部样式表，生成 CSSOM 树。
- **布局计算**：结合 DOM 树和 CSSOM 树，计算每个元素的位置和尺寸。
- **绘制页面**：将布局结果转换为屏幕上的像素。
- **合成页面**：如果有动画或图层效果，浏览器会进一步优化渲染。

---

#### 7. **加载额外资源**
- 浏览器解析 HTML 时，可能会发现需要加载的额外资源（如 JavaScript 文件、图片、字体等）。
- 浏览器会发起新的 HTTP 请求以加载这些资源，并将其插入到页面中。

---

#### 8. **执行 JavaScript**
- 如果页面包含 JavaScript 代码，浏览器会在适当的时间点执行这些脚本。
- JavaScript 可能会动态修改 DOM 或发起额外的网络请求（如 AJAX 请求）。

---

#### 9. **呈现最终页面**
- 当所有资源加载完成，页面呈现完毕。
- 用户可以看到完整的 Google 搜索页面。

---

#### 10. **缓存和性能优化**
- 浏览器会将部分资源（如图片、CSS、JavaScript 文件）缓存到本地，以便下次访问时更快加载。
- 如果用户再次访问 `Google.com`，浏览器可能会直接从缓存中读取资源，减少网络请求。

---

#### 总结

从输入 `Google.com` 到看到页面，整个过程涉及 **DNS 解析、TCP 连接建立、HTTP 请求与响应、浏览器渲染** 等多个阶段。每个阶段都可能受到网络条件、服务器性能和浏览器实现的影响。